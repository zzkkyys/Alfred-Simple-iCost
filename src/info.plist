<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>bundleid</key>
	<string>com.ay.icost.workflow</string>
	<key>category</key>
	<string>ay</string>
	<key>connections</key>
	<dict>
		<key>0A1B2C3D-CAT1-0000-0000-000000000003</key>
		<array>
			<dict>
				<key>destinationuid</key>
				<string>0A1B2C3D-CAT2-0000-0000-000000000004</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
		</array>
		<key>0A1B2C3D-CAT2-0000-0000-000000000004</key>
		<array>
			<dict>
				<key>destinationuid</key>
				<string>0A1B2C3D-OPEN-0000-0000-000000000005</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
		</array>
		<key>0A1B2C3D-DOIT-0000-0000-000000000011</key>
		<array>
			<dict>
				<key>destinationuid</key>
				<string>0A1B2C3D-NOTI-0000-0000-000000000012</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
		</array>
		<key>0A1B2C3D-IMPT-0000-0000-000000000010</key>
		<array>
			<dict>
				<key>destinationuid</key>
				<string>0A1B2C3D-DOIT-0000-0000-000000000011</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
		</array>
		<key>0A1B2C3D-MAIN-0000-0000-000000000001</key>
		<array>
			<dict>
				<key>destinationuid</key>
				<string>CA32F696-738A-4386-A755-384EE41A39FB</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
		</array>
		<key>6BF2DABE-7075-4735-8AC9-FF7A4641F429</key>
		<array>
			<dict>
				<key>destinationuid</key>
				<string>0A1B2C3D-CAT1-0000-0000-000000000003</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
		</array>
		<key>CA32F696-738A-4386-A755-384EE41A39FB</key>
		<array>
			<dict>
				<key>destinationuid</key>
				<string>6BF2DABE-7075-4735-8AC9-FF7A4641F429</string>
				<key>modifiers</key>
				<integer>0</integer>
				<key>modifiersubtext</key>
				<string></string>
				<key>vitoclose</key>
				<false/>
			</dict>
		</array>
	</dict>
	<key>createdby</key>
	<string>AY</string>
	<key>description</key>
	<string>ä½¿ç”¨ iCost URL Scheme å¿«é€Ÿè®°è´¦ï¼Œæ”¯æŒæ¶ˆè´¹å’Œæ”¶å…¥ï¼Œä» Excel å¯¼å…¥åˆ†ç±»</string>
	<key>disabled</key>
	<false/>
	<key>name</key>
	<string>iCost è®°è´¦</string>
	<key>objects</key>
	<array>
		<dict>
			<key>config</key>
			<dict>
				<key>alfredfiltersresults</key>
				<false/>
				<key>alfredfiltersresultsmatchmode</key>
				<integer>0</integer>
				<key>argumenttreatemptyqueryasnil</key>
				<false/>
				<key>argumenttrimmode</key>
				<integer>0</integer>
				<key>argumenttype</key>
				<integer>1</integer>
				<key>escaping</key>
				<integer>102</integer>
				<key>keyword</key>
				<string></string>
				<key>queuedelaycustom</key>
				<integer>3</integer>
				<key>queuedelayimmediatelyinitially</key>
				<true/>
				<key>queuedelaymode</key>
				<integer>0</integer>
				<key>queuemode</key>
				<integer>1</integer>
				<key>runningsubtext</key>
				<string></string>
				<key>script</key>
				<string>python3 select_category1.py "{query}"</string>
				<key>scriptargtype</key>
				<integer>0</integer>
				<key>scriptfile</key>
				<string></string>
				<key>subtext</key>
				<string></string>
				<key>title</key>
				<string>é€‰æ‹©ä¸€çº§åˆ†ç±»</string>
				<key>type</key>
				<integer>0</integer>
				<key>withspace</key>
				<false/>
			</dict>
			<key>type</key>
			<string>alfred.workflow.input.scriptfilter</string>
			<key>uid</key>
			<string>0A1B2C3D-CAT1-0000-0000-000000000003</string>
			<key>version</key>
			<integer>3</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>browser</key>
				<string></string>
				<key>skipqueryencode</key>
				<true/>
				<key>skipvarencode</key>
				<true/>
				<key>spaces</key>
				<string></string>
				<key>url</key>
				<string>{query}</string>
			</dict>
			<key>type</key>
			<string>alfred.workflow.action.openurl</string>
			<key>uid</key>
			<string>0A1B2C3D-OPEN-0000-0000-000000000005</string>
			<key>version</key>
			<integer>1</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>alfredfiltersresults</key>
				<false/>
				<key>alfredfiltersresultsmatchmode</key>
				<integer>0</integer>
				<key>argumenttreatemptyqueryasnil</key>
				<false/>
				<key>argumenttrimmode</key>
				<integer>0</integer>
				<key>argumenttype</key>
				<integer>1</integer>
				<key>escaping</key>
				<integer>102</integer>
				<key>keyword</key>
				<string></string>
				<key>queuedelaycustom</key>
				<integer>3</integer>
				<key>queuedelayimmediatelyinitially</key>
				<true/>
				<key>queuedelaymode</key>
				<integer>0</integer>
				<key>queuemode</key>
				<integer>1</integer>
				<key>runningsubtext</key>
				<string></string>
				<key>script</key>
				<string>python3 select_category2.py "{query}"</string>
				<key>scriptargtype</key>
				<integer>0</integer>
				<key>scriptfile</key>
				<string></string>
				<key>subtext</key>
				<string></string>
				<key>title</key>
				<string>é€‰æ‹©äºŒçº§åˆ†ç±»</string>
				<key>type</key>
				<integer>0</integer>
				<key>withspace</key>
				<false/>
			</dict>
			<key>type</key>
			<string>alfred.workflow.input.scriptfilter</string>
			<key>uid</key>
			<string>0A1B2C3D-CAT2-0000-0000-000000000004</string>
			<key>version</key>
			<integer>3</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>alfredfiltersresults</key>
				<false/>
				<key>alfredfiltersresultsmatchmode</key>
				<integer>0</integer>
				<key>argumenttreatemptyqueryasnil</key>
				<false/>
				<key>argumenttrimmode</key>
				<integer>0</integer>
				<key>argumenttype</key>
				<integer>1</integer>
				<key>escaping</key>
				<integer>102</integer>
				<key>keyword</key>
				<string>ic</string>
				<key>queuedelaycustom</key>
				<integer>3</integer>
				<key>queuedelayimmediatelyinitially</key>
				<true/>
				<key>queuedelaymode</key>
				<integer>0</integer>
				<key>queuemode</key>
				<integer>1</integer>
				<key>runningsubtext</key>
				<string>å¤„ç†ä¸­...</string>
				<key>script</key>
				<string>python3 icost_main.py "{query}"</string>
				<key>scriptargtype</key>
				<integer>0</integer>
				<key>scriptfile</key>
				<string></string>
				<key>subtext</key>
				<string>è¾“å…¥é‡‘é¢å¼€å§‹è®°è´¦ï¼Œæ ¼å¼: é‡‘é¢ [å¤‡æ³¨]</string>
				<key>title</key>
				<string>iCost è®°è´¦</string>
				<key>type</key>
				<integer>0</integer>
				<key>withspace</key>
				<true/>
			</dict>
			<key>type</key>
			<string>alfred.workflow.input.scriptfilter</string>
			<key>uid</key>
			<string>0A1B2C3D-MAIN-0000-0000-000000000001</string>
			<key>version</key>
			<integer>3</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>concurrently</key>
				<false/>
				<key>escaping</key>
				<integer>102</integer>
				<key>script</key>
				<string>python3 select_account.py "{query}"</string>
				<key>scriptargtype</key>
				<integer>0</integer>
				<key>scriptfile</key>
				<string></string>
				<key>type</key>
				<integer>11</integer>
			</dict>
			<key>type</key>
			<string>alfred.workflow.action.script</string>
			<key>uid</key>
			<string>CA32F696-738A-4386-A755-384EE41A39FB</string>
			<key>version</key>
			<integer>2</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>columncount</key>
				<integer>4</integer>
				<key>filterable</key>
				<true/>
				<key>fixedorder</key>
				<false/>
				<key>imageaspect</key>
				<integer>2</integer>
				<key>inputfile</key>
				<string></string>
				<key>inputtype</key>
				<integer>0</integer>
				<key>loadingtext</key>
				<string></string>
				<key>showsubtitles</key>
				<true/>
				<key>showtitles</key>
				<true/>
				<key>subtitlesinfooter</key>
				<false/>
				<key>titlesinfooter</key>
				<false/>
			</dict>
			<key>type</key>
			<string>alfred.workflow.userinterface.grid</string>
			<key>uid</key>
			<string>6BF2DABE-7075-4735-8AC9-FF7A4641F429</string>
			<key>version</key>
			<integer>1</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>alfredfiltersresults</key>
				<false/>
				<key>alfredfiltersresultsmatchmode</key>
				<integer>0</integer>
				<key>argumenttreatemptyqueryasnil</key>
				<false/>
				<key>argumenttrimmode</key>
				<integer>0</integer>
				<key>argumenttype</key>
				<integer>1</integer>
				<key>escaping</key>
				<integer>102</integer>
				<key>keyword</key>
				<string>icost:import</string>
				<key>queuedelaycustom</key>
				<integer>3</integer>
				<key>queuedelayimmediatelyinitially</key>
				<true/>
				<key>queuedelaymode</key>
				<integer>0</integer>
				<key>queuemode</key>
				<integer>1</integer>
				<key>runningsubtext</key>
				<string></string>
				<key>script</key>
				<string>python3 import_categories.py "{query}"</string>
				<key>scriptargtype</key>
				<integer>0</integer>
				<key>scriptfile</key>
				<string></string>
				<key>subtext</key>
				<string>ä» iCost å¯¼å‡ºçš„ Excel æ–‡ä»¶å¯¼å…¥åˆ†ç±»</string>
				<key>title</key>
				<string>å¯¼å…¥ iCost åˆ†ç±»</string>
				<key>type</key>
				<integer>0</integer>
				<key>withspace</key>
				<true/>
			</dict>
			<key>type</key>
			<string>alfred.workflow.input.scriptfilter</string>
			<key>uid</key>
			<string>0A1B2C3D-IMPT-0000-0000-000000000010</string>
			<key>version</key>
			<integer>3</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>concurrently</key>
				<false/>
				<key>escaping</key>
				<integer>102</integer>
				<key>script</key>
				<string>/opt/homebrew/anaconda3/bin/python do_import.py "{query}"</string>
				<key>scriptargtype</key>
				<integer>0</integer>
				<key>scriptfile</key>
				<string></string>
				<key>type</key>
				<integer>0</integer>
			</dict>
			<key>type</key>
			<string>alfred.workflow.action.script</string>
			<key>uid</key>
			<string>0A1B2C3D-DOIT-0000-0000-000000000011</string>
			<key>version</key>
			<integer>2</integer>
		</dict>
		<dict>
			<key>config</key>
			<dict>
				<key>lastpathcomponent</key>
				<false/>
				<key>onlyshowifquerypopulated</key>
				<false/>
				<key>removeextension</key>
				<false/>
				<key>text</key>
				<string>{query}</string>
				<key>title</key>
				<string>iCost åˆ†ç±»å¯¼å…¥</string>
			</dict>
			<key>type</key>
			<string>alfred.workflow.output.notification</string>
			<key>uid</key>
			<string>0A1B2C3D-NOTI-0000-0000-000000000012</string>
			<key>version</key>
			<integer>1</integer>
		</dict>
	</array>
	<key>readme</key>
	<string># iCost è®°è´¦ Alfred Workflow

ä½¿ç”¨ iCost çš„ URL Scheme å¿«é€Ÿè®°è´¦ï¼Œæ”¯æŒæ¶ˆè´¹å’Œæ”¶å…¥ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ’¸ **æ¶ˆè´¹è®°è´¦**ï¼šå¿«é€Ÿè®°å½•æ”¯å‡º
- ğŸ’° **æ”¶å…¥è®°è´¦**ï¼šå¿«é€Ÿè®°å½•æ”¶å…¥
- ğŸ“± **è´¦æˆ·é€‰æ‹©**ï¼šé€‰æ‹©ä»˜æ¬¾/æ”¶æ¬¾è´¦æˆ·
- ğŸ“ **åˆ†ç±»é€‰æ‹©**ï¼šæ”¯æŒä¸€çº§åˆ†ç±»å’ŒäºŒçº§åˆ†ç±»
- ğŸ“¥ **Excel å¯¼å…¥**ï¼šä» iCost å¯¼å‡ºçš„è´¦å•å¯¼å…¥åˆ†ç±»

## ä½¿ç”¨æ–¹æ³•

### 1. è®°è´¦ï¼ˆå…³é”®è¯ï¼š`ic`ï¼‰

```
ic é‡‘é¢ [å¤‡æ³¨]
```

**ç¤ºä¾‹ï¼š**
- `ic 50` - è®°å½• 50 å…ƒ
- `ic 35.5 åˆé¤` - è®°å½• 35.5 å…ƒï¼Œå¤‡æ³¨"åˆé¤"

**æµç¨‹ï¼š**
1. è¾“å…¥é‡‘é¢åå›è½¦
2. é€‰æ‹©"æ¶ˆè´¹"æˆ–"æ”¶å…¥"
3. é€‰æ‹©ä»˜æ¬¾/æ”¶æ¬¾è´¦æˆ·
4. é€‰æ‹©ä¸€çº§åˆ†ç±»
5. é€‰æ‹©äºŒçº§åˆ†ç±»
6. è‡ªåŠ¨æ‰“å¼€ iCost å®Œæˆè®°è´¦

### 2. å¯¼å…¥åˆ†ç±»ï¼ˆå…³é”®è¯ï¼š`icost:import`ï¼‰

```
icost:import /path/to/your/icost_export.xlsx
```

**è¯´æ˜ï¼š**
- ä» iCost å¯¼å‡ºçš„ Excel è´¦å•æ–‡ä»¶ä¸­è¯»å–åˆ†ç±»
- Excel æ–‡ä»¶éœ€åŒ…å«ä»¥ä¸‹åˆ—ï¼šç±»å‹ã€ä¸€çº§åˆ†ç±»ã€äºŒçº§åˆ†ç±»ã€è´¦æˆ·
- å¯¼å…¥åä¼šè‡ªåŠ¨åˆå¹¶åˆ°ç°æœ‰åˆ†ç±»æ•°æ®åº“

## æ–‡ä»¶ç»“æ„

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `icost_main.py` | ä¸»å…¥å£è„šæœ¬ |
| `select_account.py` | è´¦æˆ·é€‰æ‹© |
| `select_category1.py` | ä¸€çº§åˆ†ç±»é€‰æ‹© |
| `select_category2.py` | äºŒçº§åˆ†ç±»é€‰æ‹© |
| `import_categories.py` | å¯¼å…¥åˆ†ç±»ç•Œé¢ |
| `do_import.py` | æ‰§è¡Œå¯¼å…¥æ“ä½œ |
| `icost_data.json` | åˆ†ç±»å’Œè´¦æˆ·æ•°æ® |

## iCost URL Scheme æ ¼å¼

### æ”¯å‡º
```
iCost://expense?amount=é‡‘é¢&amp;account=è´¦æˆ·&amp;category=åˆ†ç±»&amp;remark=å¤‡æ³¨
```

### æ”¶å…¥
```
iCost://income?amount=é‡‘é¢&amp;account=è´¦æˆ·&amp;category=åˆ†ç±»&amp;remark=å¤‡æ³¨
```

## ä¾èµ–

- Python 3
- openpyxlï¼ˆä»…å¯¼å…¥ Excel æ—¶éœ€è¦ï¼‰

å®‰è£… openpyxlï¼š
```bash
pip3 install openpyxl
```

## è‡ªå®šä¹‰åˆ†ç±»

ç¼–è¾‘ `icost_data.json` æ–‡ä»¶å¯æ‰‹åŠ¨æ·»åŠ æˆ–ä¿®æ”¹åˆ†ç±»å’Œè´¦æˆ·ï¼š

```json
{
  "accounts": ["å¾®ä¿¡", "æ”¯ä»˜å®", "ç°é‡‘"],
  "expense_categories": {
    "é¤é¥®": ["æ—©é¤", "åˆé¤", "æ™šé¤"],
    "äº¤é€š": ["å…¬äº¤", "åœ°é“", "æ‰“è½¦"]
  },
  "income_categories": {
    "å·¥èµ„": ["åŸºæœ¬å·¥èµ„", "å¥–é‡‘"],
    "å…¶ä»–": ["çº¢åŒ…", "æŠ¥é”€"]
  }
}
```
</string>
	<key>uidata</key>
	<dict>
		<key>0A1B2C3D-CAT1-0000-0000-000000000003</key>
		<dict>
			<key>xpos</key>
			<integer>980</integer>
			<key>ypos</key>
			<integer>40</integer>
		</dict>
		<key>0A1B2C3D-CAT2-0000-0000-000000000004</key>
		<dict>
			<key>xpos</key>
			<integer>1180</integer>
			<key>ypos</key>
			<integer>40</integer>
		</dict>
		<key>0A1B2C3D-DOIT-0000-0000-000000000011</key>
		<dict>
			<key>xpos</key>
			<integer>250</integer>
			<key>ypos</key>
			<integer>200</integer>
		</dict>
		<key>0A1B2C3D-IMPT-0000-0000-000000000010</key>
		<dict>
			<key>xpos</key>
			<integer>50</integer>
			<key>ypos</key>
			<integer>200</integer>
		</dict>
		<key>0A1B2C3D-MAIN-0000-0000-000000000001</key>
		<dict>
			<key>xpos</key>
			<integer>50</integer>
			<key>ypos</key>
			<integer>50</integer>
		</dict>
		<key>0A1B2C3D-NOTI-0000-0000-000000000012</key>
		<dict>
			<key>xpos</key>
			<integer>450</integer>
			<key>ypos</key>
			<integer>200</integer>
		</dict>
		<key>0A1B2C3D-OPEN-0000-0000-000000000005</key>
		<dict>
			<key>xpos</key>
			<integer>1380</integer>
			<key>ypos</key>
			<integer>40</integer>
		</dict>
		<key>6BF2DABE-7075-4735-8AC9-FF7A4641F429</key>
		<dict>
			<key>note</key>
			<string>ä»¥grid viewæ˜¾ç¤ºè´¦æˆ·</string>
			<key>xpos</key>
			<integer>445</integer>
			<key>ypos</key>
			<integer>50</integer>
		</dict>
		<key>CA32F696-738A-4386-A755-384EE41A39FB</key>
		<dict>
			<key>note</key>
			<string>1. é€‰æ‹©è´¦æˆ·</string>
			<key>xpos</key>
			<integer>245</integer>
			<key>ypos</key>
			<integer>50</integer>
		</dict>
	</dict>
	<key>userconfigurationconfig</key>
	<array/>
	<key>version</key>
	<string>1.0.1</string>
	<key>webaddress</key>
	<string></string>
</dict>
</plist>
